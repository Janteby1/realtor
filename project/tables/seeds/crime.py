from tables.models import Neighborhood, Score
from decimal import *

crime_results = [{'Bay Ridge': Decimal('24.66')}, {'Dyker Heights': Decimal('24.66')}, {"Annadale-Huguenot-Prince's Bay-Eltingville": Decimal('9.005')}, {'Arden Heights': Decimal('9.005')}, {'Rossville-Woodrow': Decimal('9.005')}, {'Charleston-Richmond Valley-Tottenville': Decimal('9.005')}, {'Highbridge': Decimal('65.98')}, {'West Concourse': Decimal('65.98')}, {'East Concourse-Concourse Village': Decimal('65.98')}, {'Erasmus': Decimal('56.04')}, {'East Flatbush-Farragut': Decimal('56.04')}, {'Rugby-Remsen Village': Decimal('56.04')}, {'Jackson Heights': Decimal('47.06')}, {'East Elmhurst': Decimal('47.06')}, {'North Corona': Decimal('47.06')}, {'East Harlem South': Decimal('27.48')}, {'North Riverdale-Fieldston-Riverdale': Decimal('24.50')}, {'Spuyten Duyvil-Kingsbridge': Decimal('24.50')}, {'Van Cortlandt Village': Decimal('24.50')}, {'Washington Heights South': Decimal('21.42')}, {'Washington Heights North': Decimal('21.42')}, {'Marble Hill-Inwood': Decimal('21.42')}, {'Upper West Side': Decimal('26.10')}, {'Stuyvesant Heights': Decimal('37.48')}, {'Georgetown-Marine Park-Bergen Beach-Mill Basi': Decimal('29.30')}, {'Flatlands': Decimal('29.30')}, {'SoHo-TriBeCa-Civic Center-Little Italy': Decimal('36.66')}, {'Battery Park City-Lower Manhattan': Decimal('36.66')}, {'Morningside Heights': Decimal('15.38')}, {'Westchester-Unionport': Decimal('66.00')}, {'Parkchester': Decimal('66.00')}, {'West Farms-Bronx River': Decimal('66.00')}, {'Soundview-Bruckner': Decimal('66.00')}, {'Soundview-Castle Hill-Clason Point-Harding Pa': Decimal('66.00')}, {'Midwood': Decimal('43.60')}, {'Flatbush': Decimal('43.60')}, {'Queensboro Hill': Decimal('48.28')}, {'East Flushing': Decimal('48.28')}, {'Flushing': Decimal('48.28')}, {'Murray Hill': Decimal('48.28')}, {'College Point': Decimal('48.28')}, {'Whitestone': Decimal('48.28')}, {'Ft. Totten-Bay Terrace-Clearview': Decimal('48.28')}, {'University Heights-Morris Heights': Decimal('48.95')}, {'Mount Hope': Decimal('48.95')}, {'Morrisania-Melrose': Decimal('35.89')}, {'Claremont-Bathgate': Decimal('35.89')}, {'Crotona Park East': Decimal('35.89')}, {'Borough Park': Decimal('29.48')}, {'Kensington-Ocean Parkway': Decimal('29.48')}, {'Ocean Parkway South': Decimal('29.48')}, {'Auburndale': Decimal('20.28')}, {'Douglas Manor-Douglaston-Little Neck': Decimal('20.28')}, {'Bayside-Bayside Hills': Decimal('20.28')}, {'Oakland Gardens': Decimal('20.28')}, {'Old Astoria': Decimal('46.07')}, {'Astoria': Decimal('46.07')}, {'Steinway': Decimal('46.07')}, {'South Jamaica': Decimal('42.18')}, {'Baisley Park': Decimal('42.18')}, {'St. Albans': Decimal('42.18')}, {'Norwood': Decimal('56.02')}, {'Bedford Park-Fordham North': Decimal('56.02')}, {'Kingsbridge Heights': Decimal('56.02')}, {'Breezy Point-Belle Harbor-Rockaway Park-Broad': Decimal('13.31')}, {'Hammels-Arverne-Edgemere': Decimal('13.31')}, {'Greenpoint': Decimal('25.90')}, {'Longwood': Decimal('31.10')}, {'Hunts Point': Decimal('31.10')}, {'Grasmere-Arrochar-Ft. Wadsworth': Decimal('17.44')}, {'Old Town-Dongan Hills-South Beach': Decimal('17.44')}, {'Todt Hill-Emerson Hill-Heartland Village-Ligh': Decimal('17.44')}, {'Great Kills': Decimal('17.44')}, {'Oakwood-Oakwood Beach': Decimal('17.44')}, {'New Dorp-Midland Beach': Decimal('17.44')}, {'Jamaica': Decimal('45.79')}, {'Hollis': Decimal('45.79')}, {'West Village': Decimal('38.57')}, {'Fort Greene': Decimal('24.30')}, {'Clinton Hill': Decimal('24.30')}, {'Ridgewood': Decimal('35.04')}, {'Glendale': Decimal('35.04')}, {'Middle Village': Decimal('35.04')}, {'Maspeth': Decimal('35.04')}, {'Stapleton-Rosebank': Decimal('30.38')}, {'Grymes Hill-Clifton-Fox Hills': Decimal('30.38')}, {'New Brighton-Silver Lake': Decimal('30.38')}, {'West New Brighton-New Brighton-St. George': Decimal('30.38')}, {'Canarsie': Decimal('27.95')}, {'Elmhurst': Decimal('39.30')}, {'Elmhurst-Maspeth': Decimal('39.30')}, {'Corona': Decimal('39.30')}, {'Woodhaven': Decimal('37.46')}, {'Kew Gardens': Decimal('37.46')}, {'Richmond Hill': Decimal('37.46')}, {'Allerton-Pelham Gardens': Decimal('32.44')}, {'Pelham Parkway': Decimal('32.44')}, {'Van Nest-Morris Park-Westchester Square': Decimal('32.44')}, {'Bronxdale': Decimal('32.44')}, {'Far Rockaway-Bayswater': Decimal('25.06')}, {'Co-Op City': Decimal('32.15')}, {'Schuylerville-Throgs Neck-Edgewater Park': Decimal('32.15')}, {'Pelham Bay-Country Club-City Island': Decimal('32.15')}, {'Lincoln Square': Decimal('22.18')}, {'Hunters Point-Sunnyside-West Maspeth': Decimal('28.60')}, {'Woodside': Decimal('28.60')}, {'Queensbridge-Ravenswood-Long Island City': Decimal('28.60')}, {'DUMBO-Vinegar Hill-Downtown Brooklyn-Boerum H': Decimal('28.54')}, {'Brooklyn Heights-Cobble Hill': Decimal('28.54')}, {'Lower East Side': Decimal('20.35')}, {'Westerleigh': Decimal('28.10')}, {'Port Richmond': Decimal('28.10')}, {"Mariner's Harbor-Arlington-Port Ivory-Granite": Decimal('28.10')}, {'New Springville-Bloomfield-Travis': Decimal('28.10')}, {'East Harlem North': Decimal('30.20')}, {'Midtown-Midtown South': Decimal('71.38')}, {'Ozone Park': Decimal('40.74')}, {'South Ozone Park': Decimal('40.74')}, {'Lindenwood-Howard Beach': Decimal('40.74')}, {'Bensonhurst East': Decimal('32.22')}, {'Bensonhurst West': Decimal('32.22')}, {'Bath Beach': Decimal('32.22')}, {'Central Harlem South': Decimal('24.96')}, {'Brownsville': Decimal('46.88')}, {'Ocean Hill': Decimal('46.88')}, {'Turtle Bay-East Midtown': Decimal('25.06')}, {'Murray Hill-Kips Bay': Decimal('25.06')}, {'Crown Heights South': Decimal('39.56')}, {'Prospect Lefferts Gardens-Wingate': Decimal('39.56')}, {'Central Harlem North-Polo Grounds': Decimal('30.14')}, {'Sunset Park West': Decimal('30.52')}, {'Sunset Park East': Decimal('30.52')}, {'Windsor Terrace': Decimal('30.52')}, {'Kew Gardens Hills': Decimal('28.28')}, {'Jamaica Estates-Holliswood': Decimal('28.28')}, {'Fresh Meadows-Utopia': Decimal('28.28')}, {'Pomonok-Flushing Heights-Hillcrest': Decimal('28.28')}, {'Briarwood-Jamaica Hills': Decimal('28.28')}, {'Hamilton Heights': Decimal('19.42')}, {'Manhattanville': Decimal('19.42')}, {'Park Slope-Gowanus': Decimal('24.86')}, {'Bedford': Decimal('40.72')}, {'Clinton': Decimal('59.96')}, {'Gramercy': Decimal('52.64')}, {'Stuyvesant Town-Cooper Village': Decimal('52.64')}, {'Gravesend': Decimal('38.44')}, {'Madison': Decimal('38.44')}, {'Homecrest': Decimal('38.44')}, {'Sheepshead Bay-Gerritsen Beach-Manhattan Beac': Decimal('38.44')}, {'Cypress Hills-City Line': Decimal('92.80')}, {'East New York': Decimal('92.80')}, {'East New York (Pennsylvania Ave)': Decimal('92.80')}, {'Starrett City': Decimal('92.80')}, {'Hudson Yards-Chelsea-Flat Iron-Union Square': Decimal('27.18')}, {'Carroll Gardens-Columbia Street-Red Hook': Decimal('16.26')}, {'Bushwick North': Decimal('43.78')}, {'Bushwick South': Decimal('43.78')}, {'Crown Heights North': Decimal('39.53')}, {'Prospect Heights': Decimal('39.53')}, {'Eastchester-Edenwald-Baychester': Decimal('54.98')}, {'Williamsbridge-Olinville': Decimal('54.98')}, {'Woodlawn-Wakefield': Decimal('54.98')}, {'East Village': Decimal('34.26')}, {'Seagate-Coney Island': Decimal('36.98')}, {'West Brighton': Decimal('36.98')}, {'Brighton Beach': Decimal('36.98')}, {'Mott Haven-Port Morris': Decimal('56.35')}, {'Melrose South-Mott Haven North': Decimal('56.35')}, {'Glen Oaks-Floral Park-New Hyde Park': Decimal('51.02')}, {'Bellerose': Decimal('51.02')}, {'Queens Village': Decimal('51.02')}, {'Cambria Heights': Decimal('51.02')}, {'Laurelton': Decimal('51.02')}, {'Springfield Gardens North': Decimal('51.02')}, {'Rosedale': Decimal('51.02')}, {'Springfield Gardens South-Brookville': Decimal('51.02')}, {'Forest Hills': Decimal('16.89')}, {'Rego Park': Decimal('16.89')}, {'North Side-South Side': Decimal('42.48')}, {'East Williamsburg': Decimal('42.48')}, {'Williamsburg': Decimal('42.48')}, {'East Tremont': Decimal('47.98')}, {'Belmont': Decimal('47.98')}, {'Fordham South': Decimal('47.98')}, {'Upper East Side-Carnegie Hill': Decimal('48.32')}, {'Yorkville': Decimal('48.32')}, {'Lenox Hill-Roosevelt Island': Decimal('48.32')}, {'Chinatown': Decimal('24.52')}]

def update_crime_score(crime_list):
	for item in crime_list:
		for neighborhood in item:
			nb_obj = Neighborhood.objects.filter(name=neighborhood)

			if nb_obj:
				nb_obj = nb_obj[0]
				score_list = Score.objects.filter(neighborhood=nb_obj)
				print("got score list",score_list)
				if score_list:
					score_list[0].crime_score = item[neighborhood]
					score_list[0].save()
				else:
					score_list = Score.objects.create(
						neighborhood=nb_obj,
						night_life_score=0,
						commute_score=0,
						crime_score=item[neighborhood],
						noise_score=0,
					)
					print("created new score")
			else:
				print("Item not found", neighborhood)
	return True

def run():
	update_crime_score(crime_results)




